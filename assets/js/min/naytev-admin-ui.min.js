function naytevHandleMetaFields(){jQuery("li.wp_naytev_variant_meta").each(function(){jQuery(this).children("input").each(function(e,t){jQuery(t).val()==jQuery(t).attr("placeholder")&&jQuery(t).val("");var a=jQuery(t).attr("wpn_subfield");"undefined"!=typeof a&&a!==!1&&!jQuery(t).hasClass("naytev_img_upload_field")&&jQuery(t).is(":visible")&&charLimit(t,a)});var e=jQuery(this).find("input.variant_id");sv_id=e,1<sv_id.val().length&&(jQuery(this).children("input").attr("readonly",!0),jQuery(this).children("input").remove(".fieldcounter"))})}function naytevGetVariantField(e){var t=jQuery(e).find("input.variant_id");return t}function naytevCheckIfSent(e){var t=jQuery(e).children("input.variant_id");return sv_id=t.val(),1>sv_id.length?!1:!0}function fbTemplate(e){if(jQuery(e).hasClass("fb_title")){var t=jQuery(e).val();jQuery(".fb.naytev_template .js-facebookTitle").html(t)}if(jQuery(e).hasClass("fb_caption")){var t=jQuery(e).val();jQuery(".fb.naytev_template .js-facebookCaption").html(t)}if(jQuery(e).hasClass("fb_description")){var t=jQuery(e).val();jQuery(".fb.naytev_template .js-facebookDescription").html(t)}if(jQuery(e).hasClass("fb_image__uploadfield")){var t=jQuery(e).val();jQuery(".fb.naytev_template .js-facebookPostImage").attr("src",t)}}function twTemplate(e){var t=jQuery(e).val();jQuery(".tw.naytev_template .js-tweetText").html(t)}function getNaytevInputsFromH3(e){var t=jQuery(e).parent("li"),a=jQuery(t).children("input");return a}function watchAndDemoTemplate(){jQuery("#wp_naytev_fb_social_box").on("keyup","input",function(){fbTemplate(this)}),jQuery("#wp_naytev_fb_social_box").on("click","h3",function(){var e=getNaytevInputsFromH3(this);e.each(function(){fbTemplate(this)})}),jQuery("#wp_naytev_fb_social_box .activebox .fb_image__uploadfield").bind("propertychange keyup input paste change",function(){var e=jQuery(this).val();jQuery(".fb.naytev_template .js-facebookPostImage").attr("src",e)}),setInterval(function(){if("undefined"!=typeof jQuery("#wp_naytev_fb_social_box .activebox .fb_image__uploadfield")&&"undefined"!=typeof jQuery("#wp_naytev_fb_social_box .activebox .fb_image__uploadfield").val()){var e=jQuery("#wp_naytev_fb_social_box .activebox .fb_image__uploadfield").val();2<e.length&&jQuery(".fb.naytev_template .js-facebookPostImage").attr("src",e)}},1e3),jQuery("#wp_naytev_twt_social_box").on("keyup","input",function(){twTemplate(this)}),jQuery("#wp_naytev_twt_social_box").on("click","h3",function(){var e=(jQuery(this).parent("li"),getNaytevInputsFromH3(this));twTemplate(e)})}function charLimit(e,t){var a=0,n=100;"fb_title"==t||"fb_caption"==t?n=50:"twt_text"==t&&(n=125),a=n-jQuery(e).val().length,"true"!=jQuery(e).attr("wpn_active")&&(jQuery(e).before("<span class='fieldcounter char_count_"+t+"'>You have  <strong>"+a+"</strong> characters remaining</span><br />"),jQuery(e).attr("wpn_active","true")),jQuery(e).keyup(function(){jQuery(this).val().length>n&&jQuery(this).val(jQuery(this).val().substr(0,n));var a=n-jQuery(this).val().length,r=jQuery(e).parent("li").attr("id");jQuery("#"+r+" .char_count_"+t).html("You have  <strong>"+a+"</strong> characters remaining")})}function naytevFormOf(e){var t=jQuery("#wp_naytev_template_box .tw"),a=jQuery("#wp_naytev_template_box .fb");return"twitter"==e?t:"facebook"==e?a:!1}function naytevAccordClick(){jQuery("#post-body").on("click",".naytev h3.repeat-meta",function(){var e=jQuery(this).parent(".repeat-element"),t=jQuery(e).attr("id"),a=jQuery(this).parents(".repeater-container"),n=a.attr("id");jQuery(this).hasClass("inactive")?(naytevAccordShrink(n),naytevAccordExpand(t)):naytevAccordShrink(n)})}function naytevAccordShrink(e){jQuery("#"+e+" li.repeat-element > *").hide(),jQuery("#"+e+" li.repeat-element").removeClass("activebox"),jQuery("#"+e+" li.repeat-element > h3").show(),jQuery("#"+e+" li.repeat-element").each(function(){var e=jQuery(this).children("input").first().val(),t=e.substring(0,33),a=t+"...",n=jQuery(this).attr("id");jQuery("#"+n+" .heading-content").html(a)}),jQuery("#"+e+" li.repeat-element > h3").addClass("inactive"),jQuery("#"+e+" li.repeat-element > h3 > .expandState").html("+ "),naytevFetchStats()}function naytevAccordExpand(e){jQuery("#"+e+" > *").show(),jQuery("#"+e+" > h3 > .expandState").html("- "),jQuery("#"+e+" > h3").removeClass("inactive"),jQuery("#"+e).addClass("activebox"),jQuery("#"+e+" > .repeat-element-remover").after(naytevArchiveButton())}function naytevArchiveButton(){var e='<button class="btn btn-sm btn-danger armArchive"><i class="fa fa-power-off"></i> Archive</button>';return e}function naytevFetchStats(){jQuery.each(jQuery("#post-body").find("li.wp_naytev_variant_meta"),function(){var e=this,t="",a=!0;if(naytevCheckIfSent(this)){var n=naytevGetVariantField(this),r=n.val();jQuery.post(ajaxurl,{action:"get_naytev_stats_via_ajax",naytev_variant_id:r},function(n){var r=jQuery(n).find("naytev_stats").attr("id");if(""==jQuery(n).find("response_data").text()||"null"==jQuery(n).find("response_data").text())t="No shares yet!";else{var i=jQuery(n).find("totalInteractions"),u=(jQuery(n).find("clicksPerShare"),jQuery(n).find("retweets"),jQuery(n).find("clicks"),jQuery(n).find("favorites"),jQuery(n).find("statusOf"));a=u.text(),i=i.text(),t=0==i?"No shares yet!":"Interactions: "+i}if("archived"==a||"inactive"==a)a=!1,jQuery(e).hide();else{var y=jQuery('input[value="'+r+'"]').closest("li"),v=jQuery(y).attr("id"),s=jQuery("#"+v),o=s.find("h3");o.children(".naytev-stats").length?o.children(".naytev-stats").html(t):o.append('<span class="naytev-stats">'+t+"</span>")}})}})}function naytevFetchVariantStats(e){var t="";return jQuery.post(ajaxurl,{action:"get_naytev_stats_via_ajax",naytev_variant_id:e},function(e){return t=e,e}),t}function naytevVariantStatus(){jQuery("li.wp_naytev_variant_meta").each(function(){var e=this;if(naytevCheckIfSent(this)){var t=naytevGetVariantField(this),a=t.val();jQuery.post(ajaxurl,{action:"naytev_variant_status_is",naytev_variant_id:a},function(t){jQuery(t).find("naytev_status").attr("id");if("null"==jQuery(t).find("response_data").text());else{var a=jQuery(t).find("response_data").text();("archived"==a||"inactive"==a)&&jQuery(e).hide()}})}})}function naytevArchiveClick(){jQuery("#post-body").on("click",".armArchive",function(e){console.log(e);var t=jQuery(e.currentTarget).parent("li.wp_naytev_variant_meta.activebox");return naytevArchiveVariant(t),!1})}function naytevArchiveVariant(e){if(console.log(e),naytevCheckIfSent(e)){var t=naytevGetVariantField(e),a=t.val();jQuery.post(ajaxurl,{action:"naytev_variant_status_is",naytev_variant_id:a,naytev_status_set:"archived"},function(t){jQuery(t).find("naytev_status").attr("id");if("null"==jQuery(t).find("response_data").text());else{var a=jQuery(t).find("response_data").text();("archived"==a||"inactive"==a)&&jQuery(e).hide()}})}}function naytevVariantSetArchived(){}function naytevStateArchiveVariant(){}jQuery(document).ready(function(){jQuery("#wp_naytev_fb_social_box ul").after(naytevFormOf("facebook")),jQuery("#wp_naytev_fb_social_box li").first().addClass("activebox"),jQuery("#wp_naytev_twt_social_box ul").after(naytevFormOf("twitter")),jQuery("#wp_naytev_twt_social_box li").first().addClass("activebox"),naytevHandleMetaFields(),naytevAccordClick(),watchAndDemoTemplate(),naytevAccordShrink("repeater-wp_naytev_variant_meta-twt"),naytevAccordShrink("repeater-wp_naytev_variant_meta-fb");var e=jQuery("#repeater-wp_naytev_variant_meta-twt li:first").attr("id"),t=jQuery("#repeater-wp_naytev_variant_meta-fb li:first").attr("id");naytevAccordExpand(e),naytevAccordExpand(t),naytevArchiveClick()});